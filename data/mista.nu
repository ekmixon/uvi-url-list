http://mista.nu/blog/2010/12/01/windows-class-handling-gone-wrong/
